describe("Element methods",function(){var e;beforeEach(function(){e=Snap(100,100)});afterEach(function(){e.remove()});it("Element.add (for Element)",function(){var t=e.rect(10,20,30,40),n=e.add(t);expect(t.node.parentNode).to.be(e.node);expect(e.node.lastChild).to.be(t.node);expect(n).to.be(e)});it("Element.add (for Set)",function(){var t=e.rect(10,20,30,40),n=e.rect(10,20,30,40),r=Snap.set(t,n),i=e.add(r);expect(t.node.parentNode).to.be(e.node);expect(n.node.parentNode).to.be(e.node);expect(i).to.be(e)});it("Element.append (for Element)",function(){var t=e.rect(10,20,30,40),n=e.append(t);expect(t.node.parentNode).to.be(e.node);expect(e.node.lastChild).to.be(t.node);expect(n).to.be(e)});it("Element.appendTo (for Element)",function(){var t=e.rect(10,20,30,40),n=t.appendTo(e);expect(t.node.parentNode).to.be(e.node);expect(e.node.lastChild).to.be(t.node);expect(n).to.be(t)});it("Element.append (for Set)",function(){var t=e.rect(10,20,30,40),n=e.rect(10,20,30,40),r=Snap.set(t,n),i=e.append(r);expect(t.node.parentNode).to.be(e.node);expect(n.node.parentNode).to.be(e.node);expect(i).to.be(e)});it("Element.after",function(){var t=e.circle(10,20,30),n=e.rect(10,20,30,40),r=t.after(n);expect(t.node.nextSibling).to.be(n.node);expect(r).to.be(t)});it("Element.prepend",function(){var t=e.rect(10,20,30,40),n=e.circle(10,20,30),r=e.group();e.append(r);var i=r.prepend(t);expect(r.node.firstChild).to.be(t.node);expect(i).to.be(r);i=r.prepend(n);expect(r.node.firstChild).to.be(n.node);expect(i).to.be(r)});it("Element.prependTo",function(){var t=e.rect(10,20,30,40),n=e.circle(10,20,30),r=e.group();e.append(r);var i=t.prependTo(r);expect(r.node.firstChild).to.be(t.node);expect(i).to.be(t);i=n.prependTo(r);expect(r.node.firstChild).to.be(n.node);expect(i).to.be(n)});it("Element.insertAfter",function(){var t=e.circle(10,20,30),n=e.rect(10,20,30,40),r=n.insertAfter(t);expect(t.node.nextSibling).to.be(n.node);expect(r).to.be(n)});it("Element.before",function(){var t=e.circle(10,20,30),n=e.rect(10,20,30,40),r=t.before(n);expect(t.node.previousSibling).to.be(n.node);expect(r).to.be(t)});it("Element.insertBefore",function(){var t=e.circle(10,20,30),n=e.rect(10,20,30,40),r=n.insertBefore(t);expect(t.node.previousSibling).to.be(n.node);expect(r).to.be(n)});it("Element.clone",function(){var t=e.circle(10,20,30);e.append(t);var n=t.clone();expect(t.node).not.to.be(n.node);expect(n.node.getAttribute("cx")).to.be("10");expect(n.node.getAttribute("cy")).to.be("20");expect(n.node.getAttribute("r")).to.be("30")});it("Element.parent",function(){var t=e.circle(10,20,30);e.append(t);var n=t.parent();expect(n.node).to.be(e.node)});it("Element.remove",function(){var t=e.rect(10,20,30,40);expect(t.node.parentNode).to.be(e.node);var n=t.remove();expect(t.node.parentNode).to.be(null);expect(n).to.be(t)});it("Element.attr - get",function(){var t=e.circle(10,20,30),n=t.attr("r");expect(n).to.be("30")});it("Element.attr - set",function(){var t=e.circle(10,20,30);t.attr({cx:1,cy:2,r:3});var n=t.node.getAttribute("cx"),r=t.node.getAttribute("cy"),i=t.node.getAttribute("r");expect(n).to.be("1");expect(r).to.be("2");expect(i).to.be("3")});it("Element.attr - set on group",function(){var t=e.group();t.attr({"class":"myclass"});expect(t.node.getAttribute("class")).to.be("myclass")});it("Element.attr - textPath",function(){var t=e.text(20,20,"test");t.attr({textpath:"M10,20L100,100"});expect(t.node.firstChild.tagName).to.be("textPath")});it("Element.attr - textPath",function(){var t=e.text(20,20,"test"),n=e.path("M10,20L100,100");t.attr({textpath:n});expect(t.node.firstChild.tagName).to.be("textPath")});it("Element.data",function(){var t=e.circle(10,20,30);t.data("foo","bar");var n=t.data("foo");expect(n).to.be("bar");var r={};t.data("my-object",r);n=t.data("my-object");expect(n).to.be(r)});it("Element.removeData - with key",function(){var t=e.circle(10,20,30),n={};t.data("my-object",n);var r=t.data("my-object");expect(r).to.be(n);t.removeData("my-object");r=t.data("my-object");expect(r).to.be(undefined)});it("Element.removeData - no key",function(){var t=e.circle(10,20,30),n={},r=42;t.data("my-object",n);t.data("my-number",42);expect(t.data("my-object")).to.be(n);expect(t.data("my-number")).to.be(r);t.removeData();expect(t.data("my-object")).to.be(undefined);expect(t.data("my-number")).to.be(undefined)});it("Element.asPX - from %",function(){e.attr({width:200});var t=e.rect(0,0,"100%",10),n=t.asPX("width");expect(n).to.be(200)});it("Element.getBBox",function(){var t=e.rect(10,20,30,40),n=t.getBBox(),r=e.line(10,20,40,60),i=r.getBBox();expect(n.x).to.eql(10);expect(n.y).to.eql(20);expect(n.w).to.eql(30);expect(n.width).to.eql(30);expect(n.h).to.eql(40);expect(n.height).to.eql(40);expect(n.x2).to.eql(40);expect(n.cx).to.eql(25);expect(n.cy).to.eql(40);expect(n.y2).to.eql(60);expect(n).to.eql(i)});it("Element.getPointAtLength",function(){var t=e.path("M0,0 100,0");expect(t.getPointAtLength(50)).to.eql({x:50,y:0,m:{x:25,y:0},n:{x:75,y:0},start:{x:0,y:0},end:{x:100,y:0},alpha:180})});it("Element.getSubpath",function(){var t=e.path("M0,0 100,0");expect(t.getSubpath(10,90)).to.be("M9.995,0C29.153,0,70.839,0,90,0")});it("Element.getTotalLength",function(){var t=e.path("M0,0 100,0");expect(+t.getTotalLength("M0,0 100,0").toFixed(2)).to.be(100)});it("Element.innerSVG",function(){var t=e.group().attr({"class":"group-one"}),n=e.group().attr({"class":"group-two"}),r=e.group().attr({"class":"group-three"}),i=e.circle(10,20,30).attr({"class":"circle-one"}),o=e.circle(5,10,25).attr({"class":"circle-two"});t.add(n);n.add(r);n.add(i);r.add(o);var u=t.innerSVG();expect(u).to.match(/<g .*?class="group-two".*?>\w*<g .*?class="group-three".*?>\w*<circle .*?class="circle-two".*?>\w*<circle .*?class="circle-one".*?>/)});it("Element.toString",function(){var t=e.group(),n=e.circle(10,20,30).attr({"class":"circle-one"});t.add(n);var r=t.toString();expect(r).to.match(/<g.*?>\w*<circle .*?class="circle-one".*?>\w*<\/g>/)});it("Element.select",function(){var t=e.group(),n=e.group(),r=e.group(),i=e.circle(10,20,30).attr({"class":"circle-one"}),o=e.circle(5,10,25).attr({"class":"circle-two"});t.add(n);n.add(r);n.add(i);r.add(o);var u=t.select(".circle-one");expect(i).to.be(u);var a=t.select(".circle-two");expect(o).to.be(a)});it("Element.selectAll",function(){var t=e.group(),n=e.group(),r=e.group(),i=e.circle(10,20,30).attr({"class":"circle-one"}),o=e.circle(5,10,25).attr({"class":"circle-two"});t.add(n);n.add(r);n.add(i);r.add(o);var u=t.selectAll("circle");expect(u.length).to.be(2);expect(u).to.contain(i);expect(u).to.contain(o)});it("Element.animate",function(t){var n=e.circle(10,20,30),r=n.animate({r:50},10);setTimeout(function(){var e=n.attr("r");expect(e).to.be("50");t()},50);expect(r).to.be(n)});it("Element.animate - with callback",function(t){var n=e.circle(10,20,30),r=n.animate({r:50},10,function(){var e=n.attr("r");expect(e).to.be("50");t()});expect(r).to.be(n)});it("Element.animate - with easing",function(t){var n=e.circle(10,20,30),r=n.animate({r:50},10,mina.easein);setTimeout(function(){var e=n.attr("r");expect(e).to.be("50");t()},50);expect(r).to.be(n)});it("Element.animate - with callback & easing",function(t){var n=e.circle(10,20,30),r=n.animate({r:50},10,mina.easeout,function(){var e=n.attr("r");expect(e).to.be("50");t()});expect(r).to.be(n)});it("Element.inAnim",function(t){var n=e.circle(10,20,30);n.animate({r:50},100);n.animate({cx:100},100);setTimeout(function(){var e=n.inAnim();expect(e).to.be.an("array");expect(e.length).to.be(2);expect(e[0].anim).to.be.an("object");expect(e[0].curStatus).to.be.a("number");expect(e[0].curStatus).to.be.within(.01,.99);expect(e[0].status).to.be.a("function");expect(e[0].stop).to.be.a("function");t()},50)});it("Element.stop",function(t){var n=e.circle(10,20,30);n.animate({r:50},100);setTimeout(function(){var e=n.inAnim();expect(e.length).to.be(1);var r=n.stop();e=n.inAnim();expect(e.length).to.be(0);var i=n.attr("r");expect(i).to.be.lessThan(50);expect(r).to.be(n);t()},50)});it("Element.marker",function(){var t=e.line(0,0,10,10),n=t.marker(0,0,5,5,0,0);expect(n.node.nodeName).to.be("marker");expect(n.node.getAttribute("viewBox")).to.be("0 0 5 5");expect(n.node.getAttribute("markerWidth")).to.be("5");expect(n.node.getAttribute("markerHeight")).to.be("5");expect(n.node.getAttribute("refX")).to.be("0");expect(n.node.getAttribute("refY")).to.be("0")});it("Element.pattern",function(){var t=e.circle(10,20,30),n=t.pattern(0,0,50,50);expect(n.node.nodeName).to.be("pattern")});it("Element.transform",function(){var t=e.circle(10,20,30),n=t.transform("translate(10,10)"),r={a:1,b:0,c:0,d:1,e:10,f:10},i=t.transform();expect(i.string).to.be.a("string");expect(i.global).to.be.a("string");expect(i.globalMatrix).to.be.an("object");expect(i.globalMatrix).to.eql(r);expect(i.local).to.be.a("string");expect(i.localMatrix).to.be.an("object");expect(i.localMatrix).to.eql(r);t.transform("rotate(90)");i=t.transform();expect(i.local).to.be("r90,0,0");expect(n).to.be(t);t.transform("translate(10)");r={a:1,b:0,c:0,d:1,e:10,f:0};i=t.transform();expect(i.globalMatrix).to.eql(r)});it("Element.use",function(){var t=e.circle(10,20,30),n=t.use();expect(n.node.nodeName).to.be("use")});it("Element.toDefs",function(){var t=e.circle(10,20,30),n=t.toDefs();expect(t.node.parentElement.nodeName).to.be("defs");expect(n).to.be(t)});var t=function(e,t){var n=document.createEvent("HTMLEvents");n.initEvent(t,!0,!0);e.node.dispatchEvent(n)};(function(){var n=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","touchcancel","touchend","touchmove","touchstart"],r=function(n){return function(){var r=e.circle(10,20,30),i=0,o=function(){i++},u=r[n](o);expect(i).to.be(0);t(r,n);expect(i).to.be(1);var a=r["un"+n](o);t(r,n);expect(i).to.be(1);expect(u).to.be(r);expect(a).to.be(r)}};for(var i=0;i<n.length;i++){var o=n[i],u="Element."+o+", Element.un"+o,a=r(o);it(u,a)}})();it("Element.drag, Element.undrag - no contexts",function(){var n=e.circle(10,20,30),r=0,i=0,o=0,u=n.drag(function(e,t,n,i,s){r++;expect(e).to.be.a("number");expect(t).to.be.a("number");expect(n).to.be.a("number");expect(i).to.be.a("number");expect(s).to.be.an("object")},function(e,t,n){i++;expect(e).to.be.a("number");expect(t).to.be.a("number");expect(n).to.be.an("object")},function(e){o++;expect(e).to.be.an("object")});expect(i).to.be(0);t(n,"mousedown");expect(i).to.be(1);expect(r).to.be(0);t(n,"mousemove");expect(r).to.be(1);expect(o).to.be(0);t(n,"mouseup");expect(o).to.be(1);expect(u).to.be(n);var a=n.undrag();t(n,"mousedown");expect(i).to.be(1);t(n,"mousemove");expect(r).to.be(1);t(n,"mouseup");expect(o).to.be(1)});it("Element.drag - with contexts",function(){var n=e.circle(10,20,30),r=0,i=0,o=0,u=n.drag(function(e,t,n,i,s){r++;expect(e).to.be.a("number");expect(t).to.be.a("number");expect(n).to.be.a("number");expect(i).to.be.a("number");expect(s).to.be.an("object");expect(this.moveContext).to.be(!0)},function(e,t,n){i++;expect(e).to.be.a("number");expect(t).to.be.a("number");expect(n).to.be.an("object");expect(this.startContext).to.be(!0)},function(e){o++;expect(e).to.be.an("object");expect(this.endContext).to.be(!0)},{moveContext:!0},{startContext:!0},{endContext:!0});expect(i).to.be(0);t(n,"mousedown");expect(i).to.be(1);expect(r).to.be(0);t(n,"mousemove");expect(r).to.be(1);expect(o).to.be(0);t(n,"mouseup");expect(o).to.be(1);expect(u).to.be(n);var a=n.undrag();t(n,"mousedown");expect(i).to.be(1);t(n,"mousemove");expect(r).to.be(1);t(n,"mouseup");expect(o).to.be(1)});it("Element.hover, Element.unhover - no contexts",function(){var n=e.circle(10,20,30),r=0,i=0,o=n.hover(function(){r++},function(){i++});expect(r).to.be(0);t(n,"mouseover");expect(r).to.be(1);expect(i).to.be(0);t(n,"mouseout");expect(i).to.be(1);expect(o).to.be(n);var u=n.unhover();t(n,"mouseover");expect(r).to.be(1);t(n,"mouseout");expect(i).to.be(1);expect(u).to.be(n)});it("Element.hover, Element.unhover - with contexts",function(){var n=e.circle(10,20,30),r=0,i=0,o=n.hover(function(){r++;expect(this.inContext).to.be(!0)},function(){i++;expect(this.outContext).to.be(!0)},{inContext:!0},{outContext:!0});expect(r).to.be(0);t(n,"mouseover");expect(r).to.be(1);expect(i).to.be(0);t(n,"mouseout");expect(i).to.be(1);expect(o).to.be(n);var u=n.unhover();t(n,"mouseover");expect(r).to.be(1);t(n,"mouseout");expect(i).to.be(1);expect(u).to.be(n)});it("Snap.getElementByPoint",function(){var t=e.rect(10,10,30,30).attr({id:"id"}),n=Snap.getElementByPoint(15,15),r=Snap.getElementByPoint(45,45);expect(n.node.id).to.be("id");expect(r.node.id).to.not.be("id")})});