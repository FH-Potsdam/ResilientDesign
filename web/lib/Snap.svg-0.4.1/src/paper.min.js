// Copyright (c) 2013 Adobe Systems Incorporated. All rights reserved.
// 
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
// 
// http://www.apache.org/licenses/LICENSE-2.0
// 
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
Snap.plugin(function(e,t,n,r,i){var s=n.prototype,o=e.is;s.rect=function(e,t,n,r,i,s){var u;s==null&&(s=i);if(o(e,"object")&&e=="[object Object]")u=e;else if(e!=null){u={x:e,y:t,width:n,height:r};if(i!=null){u.rx=i;u.ry=s}}return this.el("rect",u)};s.circle=function(e,t,n){var r;o(e,"object")&&e=="[object Object]"?r=e:e!=null&&(r={cx:e,cy:t,r:n});return this.el("circle",r)};var u=function(){function e(){this.parentNode.removeChild(this)}return function(t,n){var i=r.doc.createElement("img"),s=r.doc.body;i.style.cssText="position:absolute;left:-9999em;top:-9999em";i.onload=function(){n.call(i);i.onload=i.onerror=null;s.removeChild(i)};i.onerror=e;s.appendChild(i);i.src=t}}();s.image=function(t,n,r,i,s){var a=this.el("image");if(o(t,"object")&&"src"in t)a.attr(t);else if(t!=null){var f={"xlink:href":t,preserveAspectRatio:"none"};if(n!=null&&r!=null){f.x=n;f.y=r}if(i!=null&&s!=null){f.width=i;f.height=s}else u(t,function(){e._.$(a.node,{width:this.offsetWidth,height:this.offsetHeight})});e._.$(a.node,f)}return a};s.ellipse=function(e,t,n,r){var i;o(e,"object")&&e=="[object Object]"?i=e:e!=null&&(i={cx:e,cy:t,rx:n,ry:r});return this.el("ellipse",i)};s.path=function(e){var t;o(e,"object")&&!o(e,"array")?t=e:e&&(t={d:e});return this.el("path",t)};s.group=s.g=function(e){var t,n=this.el("g");arguments.length==1&&e&&!e.type?n.attr(e):arguments.length&&n.add(Array.prototype.slice.call(arguments,0));return n};s.svg=function(e,t,n,r,i,s,u,a){var f={};if(o(e,"object")&&t==null)f=e;else{e!=null&&(f.x=e);t!=null&&(f.y=t);n!=null&&(f.width=n);r!=null&&(f.height=r);i!=null&&s!=null&&u!=null&&a!=null&&(f.viewBox=[i,s,u,a])}return this.el("svg",f)};s.mask=function(e){var t,n=this.el("mask");arguments.length==1&&e&&!e.type?n.attr(e):arguments.length&&n.add(Array.prototype.slice.call(arguments,0));return n};s.ptrn=function(e,t,n,r,i,s,u,a){if(o(e,"object"))var f=e;else{f={patternUnits:"userSpaceOnUse"};e&&(f.x=e);t&&(f.y=t);n!=null&&(f.width=n);r!=null&&(f.height=r);i!=null&&s!=null&&u!=null&&a!=null?f.viewBox=[i,s,u,a]:f.viewBox=[e||0,t||0,n||0,r||0]}return this.el("pattern",f)};s.use=function(n){if(n!=null){if(n instanceof t){n.attr("id")||n.attr({id:e._.id(n)});n=n.attr("id")}String(n).charAt()=="#"&&(n=n.substring(1));return this.el("use",{"xlink:href":"#"+n})}return t.prototype.use.call(this)};s.symbol=function(e,t,n,r){var i={};e!=null&&t!=null&&n!=null&&r!=null&&(i.viewBox=[e,t,n,r]);return this.el("symbol",i)};s.text=function(e,t,n){var r={};o(e,"object")?r=e:e!=null&&(r={x:e,y:t,text:n||""});return this.el("text",r)};s.line=function(e,t,n,r){var i={};o(e,"object")?i=e:e!=null&&(i={x1:e,x2:n,y1:t,y2:r});return this.el("line",i)};s.polyline=function(e){arguments.length>1&&(e=Array.prototype.slice.call(arguments,0));var t={};o(e,"object")&&!o(e,"array")?t=e:e!=null&&(t={points:e});return this.el("polyline",t)};s.polygon=function(e){arguments.length>1&&(e=Array.prototype.slice.call(arguments,0));var t={};o(e,"object")&&!o(e,"array")?t=e:e!=null&&(t={points:e});return this.el("polygon",t)};(function(){function n(){return this.selectAll("stop")}function r(n,r){var i=t("stop"),s={offset:+r+"%"};n=e.color(n);s["stop-color"]=n.hex;n.opacity<1&&(s["stop-opacity"]=n.opacity);t(i,s);this.node.appendChild(i);return this}function i(){if(this.type=="linearGradient"){var n=t(this.node,"x1")||0,r=t(this.node,"x2")||1,i=t(this.node,"y1")||0,s=t(this.node,"y2")||0;return e._.box(n,i,math.abs(r-n),math.abs(s-i))}var o=this.node.cx||.5,u=this.node.cy||.5,a=this.node.r||0;return e._.box(o-a,u-a,a*2,a*2)}function o(e,n){function c(e,t){var n=(t-f)/(e-l);for(var r=l;r<e;r++)s[r].offset=+(+f+n*(r-l)).toFixed(2);l=e;f=t}var r=eve("snap.util.grad.parse",null,n).firstDefined(),i;if(!r)return null;r.params.unshift(e);r.type.toLowerCase()=="l"?i=u.apply(0,r.params):i=a.apply(0,r.params);r.type!=r.type.toLowerCase()&&t(i.node,{gradientUnits:"userSpaceOnUse"});var s=r.stops,o=s.length,f=0,l=0;o--;for(var h=0;h<o;h++)"offset"in s[h]&&c(h,s[h].offset);s[o].offset=s[o].offset||100;c(o,s[o].offset);for(h=0;h<=o;h++){var p=s[h];i.addStop(p.color,p.offset)}return i}function u(s,o,u,a,f){var l=e._.make("linearGradient",s);l.stops=n;l.addStop=r;l.getBBox=i;o!=null&&t(l.node,{x1:o,y1:u,x2:a,y2:f});return l}function a(s,o,u,a,f,l){var c=e._.make("radialGradient",s);c.stops=n;c.addStop=r;c.getBBox=i;o!=null&&t(c.node,{cx:o,cy:u,r:a});f!=null&&l!=null&&t(c.node,{fx:f,fy:l});return c}var t=e._.$;s.gradient=function(e){return o(this.defs,e)};s.gradientLinear=function(e,t,n,r){return u(this.defs,e,t,n,r)};s.gradientRadial=function(e,t,n,r,i){return a(this.defs,e,t,n,r,i)};s.toString=function(){var t=this.node.ownerDocument,n=t.createDocumentFragment(),r=t.createElement("div"),i=this.node.cloneNode(!0),s;n.appendChild(r);r.appendChild(i);e._.$(i,{xmlns:"http://www.w3.org/2000/svg"});s=r.innerHTML;n.removeChild(n.firstChild);return s};s.toDataURL=function(){if(window&&window.btoa)return"data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(this)))};s.clear=function(){var e=this.node.firstChild,t;while(e){t=e.nextSibling;e.tagName!="defs"?e.parentNode.removeChild(e):s.clear.call({node:e});e=t}}})()});