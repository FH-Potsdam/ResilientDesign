////////////////////////
// House View Scripts
////////////////////////
// SVG Vars
function initFloorNavigation(){$floorNavItems=$("#svg-nav > a");goToFloor(currentFloor);$floorNavItems.click(function(e){var t=e.target.hash;oldFloor=currentFloor;currentFloor=t.replace("#","");removePopups();deactivateActiveGraphics();updateContent(currentTime);goToFloor(currentFloor);e.preventDefault();return!1})}function goToFloor(e){var t=$floorNavItems.filter(".active"),n=$floorNavItems.filter('a[href$="#'+e+'"]');t.removeClass("active");$houseSlider.attr("class",e+"-active");var r=!1;n.one("transitionend",function(e){if(r)return!1;n.addClass("active");$(this).off(e);r=!0})}function initHitAreas(){$hitAreas=$("#svg-hit-areas a").each(function(e){var t=$(this);t.click(function(e){var n=this.hash,r=$(n);console.log("area clicked!: "+n);deactivateActiveGraphics();r.attr("class","active-graphic");showPopup(t);e.stopPropagation();e.preventDefault();return!1})});$(document).click(function(e){$(".active-graphic").removeAttr("class");$popupPane.html("");e.preventDefault();return!1})}function deactivateActiveGraphics(){$(".active-graphic").removeAttr("class")}function showPopup(e){var t=e.get(0).hash,n=t.replace("#",""),r=e.position().left+.42*e.width(),i=e.position().top,s=n;if(n=="Sink_x5F_3"||n=="First_x5F_Aid_x5F_2"||n=="Sink_x5F_2"||n=="First_x5F_Aid_x5F_2"||n=="First_x5F_aid_x5F_1"||n=="WC_x5F_3"||n=="XMLID_61_"||n=="Sink_x5F_1"){s+=" right";r-=260}removePopups();var o=$('<div class="leaflet-popup leaflet-zoom-animated '+s+'" style="transform: translate3d('+r+"px, "+i+'px, 0px); bottom: 27px; left: -82px;"><a class="leaflet-popup-close-button" href="#close">Ã—</a><div class="leaflet-popup-content-wrapper"><div class="leaflet-popup-content" style="width: 260px;"><p>'+siteContentHouseMarkers[n].text+'</p></div></div><div class="leaflet-popup-tip-container"><div class="leaflet-popup-tip"></div></div></div>');$popupPane.html(o);o.find(".close").click(function(e){removePopups();e.preventDefault();e.stopPropagation();return!1});setTimeout(function(){o.css({opacity:1})},0)}function removePopups(){$popupPane.html("")}function activateGraphic(e){var t=$(e.node);t.attr("class","active-graphic")}function animateTest(){var e=new Snap.Matrix;e.scale(1.2,1.2);e.translate(30,-250);s.select("g").animate({transform:e.toTransformString()},1e3)}var svg,svgFile,g,$houseView,$houseSlider,$floorNavItems,$popupPane,currentFloor="floor-3",oldFloor="";window.onload=function(){$houseView=$("#house-view");$houseSlider=$("#house-slider");$popupPane=$('<div class="leaflet-container leaflet-popup-pane leaflet-fade-anim"></div>');$houseSlider.append($popupPane);initFloorNavigation();svg=Snap("#house");Snap.load("images/house/House_View_all_floors_new_3.svg",function(e){console.log("svg image loaded");svgFile=e;g=svgFile.select("g");var t=new Snap.Matrix;t.scale(1.2,1.2);t.translate(30,50);g.attr({transform:t});initHitAreas();svg.append(g)})};var $hitAreas,onElementClicked=function(e){$(".active-graphic").removeAttr("class");activateGraphic(this);showPopup(this,e);e.stopPropagation()};