// remap jQuery to $
function loadData(){console.log("LOAD DATA");console.log("---- "+siteContentMapFile);console.log("---- "+siteContentHouseFile);$.when($.getJSON(siteContentMapFile),$.getJSON(siteContentHouseFile)).done(function(e,t){var n=$.parseJSON(e[2].responseText),r=$.parseJSON(t[2].responseText);console.log(n);console.log(r);$.each(n,function(e,t){siteContentMap[t.id]=t});$.each(r,function(e,t){siteContentHouse[t.id]=t});console.log(">>> Site content successfully loaded!");onSiteDataLoaded()})}function initViewNavigation(){$navItems.click(function(e){var t=e.target.hash;oldView=currentView;currentView=t.replace("#","");changeView(currentView);e.preventDefault();return!1})}function changeView(e){$navItems.parents("li").removeClass("active");$navItems.filter("."+e).parent("li").addClass("active");if(currentView=="intro-view")hideContentWrap();else if(oldView=="intro-view"){showContentWrap();initViewContent(initTime)}currentView=="house-view"&&oldView=="map-view"?$contentMap.fadeOut(350,function(){showContent(currentTime);$contentHouse.fadeIn({opacity:1},350)}):currentView=="map-view"&&oldView=="house-view"&&$contentHouse.fadeOut(350,function(){showContent(currentTime);$contentMap.fadeIn({opacity:1},350)});$viewSlider.attr("class",e+"-active")}function initTimeline(){function t(t,n,r){var i=null,s=null;for(var o=0;o<e.length;o++)if(t&&e[o]<=r||n&&e[o]>=r){var u=Math.abs(r-e[o]);if(s==null||u<s){i=e[o];s=u}}return i}$timeline=$("#timeline");$guides=$("#guides > div");$timelineValue=$("#timeline-value");var e=timeValues;$slider=$("#slider").slider({orientation:"horizontal",range:!0,min:0,max:60,values:[0,3],step:1,animate:!1,create:function(e,t){},slide:function(e,n){var r=e.keyCode!=$.ui.keyCode.RIGHT,i=e.keyCode!=$.ui.keyCode.LEFT,s=t(r,i,n.value);n.value==n.values[0]?$slider.slider("values",0,s):$slider.slider("values",1,s);return!1},start:function(e,t){hideContent()},stop:function(e,t){currentTime=$slider.slider("values",1);$guides.removeClass("active").filter(".g"+currentTime).addClass("active");showContent(currentTime)}})}function initViewContent(e){currentTime=e;hideContent();$slider.slider("values",1,e);$guides.removeClass("active").filter(".g"+currentTime).addClass("active");if(currentView=="map-view"){$contentMap.show();$contentHouse.hide()}else if(currentView=="house-view"){$contentHouse.show();$contentMap.hide()}showContent(currentTime)}function hideContent(){if(currentView=="map-view"){$problemsContent.stop(!0,!0).animate({opacity:0},250);$solutionsContent.stop(!0,!0).animate({opacity:0},250)}else if(currentView=="house-view"){$flatProfileContent.stop(!0,!0).animate({opacity:0},250);$flatProblemsContent.stop(!0,!0).animate({opacity:0},250)}}function showContent(e){var t;e=e<10?"0"+e:e;if(currentView=="map-view"){t=siteContentMap;$problemsContent.stop(!0,!0).html(t["STD"+e].problemtext).animate({opacity:1},250);$solutionsContent.stop(!0,!0).html(t["STD"+e].solutionstext).animate({opacity:1},250);$mapProblemBars.find("#probbarverkehrschaos .progress-bar > div").css("width",t["STD"+e].probbarverkehrschaos+"%");$mapProblemBars.find("#probbarmedizinischenotfaelle .progress-bar > div").css("width",t["STD"+e].probbarmedizinischenotfaelle+"%");$mapProblemBars.find("#probbarkriminalitaet .progress-bar > div").css("width",t["STD"+e].probbarkriminalitaet+"%");$mapProblemBars.find("#probbarpanik .progress-bar > div").css("width",t["STD"+e].probbarpanik+"%");$mapSolutionBars.find("#resbarkommunikation .progress-bar > div").css("width",t["STD"+e].resbarkommunikation+"%");$mapSolutionBars.find("#resbarversorgung .progress-bar > div").css("width",t["STD"+e].resbarversorgung+"%");$mapSolutionBars.find("#resbarwhatever .progress-bar > div").css("width",t["STD"+e].resbarwhatever+"%");$mapSolutionBars.find("#resbarsozialerzusammenhalt .progress-bar > div").css("width",t["STD"+e].resbarsozialerzusammenhalt+"%")}else if(currentView=="house-view"){t=siteContentHouse;$flatProfileContent.stop(!0,!0).html(t.Steckbrief.altedame).animate({opacity:1},250);$flatProblemsContent.stop(!0,!0).html(t["STD"+e].altedame).animate({opacity:1},250)}}function updateContent(e){hideContent();showContent(e)}function showContentWrap(){$contentWrap.removeClass("hidden")}function hideContentWrap(){$contentWrap.addClass("hidden")}function resizeSite(){windowWidth=$window.width();windowHeight=$window.height()}function onLoad(){initViewNavigation();initTimeline();loadData()}function onSiteDataLoaded(){initViewContent(initTime)}function mapInRange(e,t,n,r,i){return(i-r)*(e-t)/(n-t)+r}(function(e){})(window.jQuery);var $window,$scrollElement,$nav,$navItems,$container,$viewSlider,$views,$slider,$guides,$timeline,$timelineValue,$contentWrap,$content,$contentMap,$problemsContent,$solutionsContent,$contentHouse,$flatProfileContent,$flatProblemsContent,$mapProblemBars,$mapSolutionBars,$houseProblemBars,$houseSolutionBars,$footer,initView="map-view",currentView="",oldView="",currentFlat="",windowWidth,windowHeight,siteContentMap=[],siteContentHouse=[],siteContentMapFile="data/RD_contentTableMap_export01.json",siteContentHouseFile="data/RD_contentTablePersona_export01.json",initTime=0,currentTime=initTime,timeValues=[0,3,6,12,24,48];$(document).ready(function(){$window=$(window);$scrollElement=$("html, body").scrollTop(0);$nav=$("#view-nav");$navItems=$nav.find("a");$container=$("#container");$viewSlider=$container.find("#view-slider");$views=$viewSlider.find("section");$contentWrap=$("#content-wrap");$content=$contentWrap.find("#content");$contentMap=$content.find("#content-map");$contentHouse=$content.find("#content-house");$problemsContent=$content.find("#problems-content");$solutionsContent=$content.find("#solutions-content");$flatProfileContent=$content.find("#flat-profile-content");$flatProblemsContent=$content.find("#flat-problems-content");$mapProblemBars=$content.find("#map-problem-bars");$mapSolutionBars=$content.find("#map-solution-bars");$houseProblemBars=$content.find("#house-problem-bars");$houseSolutionBars=$content.find("#house-solution-bars");$footer=$("footer");resizeSite();$(window).resize(resizeSite);currentView=initView;changeView(currentView);$(window).load(onLoad)});$.widget("ui.slider",$.ui.slider,{_mouseCapture:function(e){var t,n,r,i,s,o,u,a,f=this,l=this.options;if(l.disabled)return!1;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();t={x:e.pageX,y:e.pageY};n=this._normValueFromMouse(t);r=this._valueMax()-this._valueMin()+1;this.handles.each(function(e){if(!$(this).hasClass("ui-slider-handle-disabled")){var t=Math.abs(n-f.values(e));if(r>t||r===t&&(e===f._lastChangedValue||f.values(e)===l.min)){r=t;i=$(this);s=e}}});if(typeof i=="undefined")return!1;o=this._start(e,s);if(o===!1)return!1;this._mouseSliding=!0;this._handleIndex=s;i.addClass("ui-state-active").focus();u=i.offset();a=!$(e.target).parents().addBack().is(".ui-slider-handle")||$(e.target).parents().addBack().is(".ui-slider-handle-disabled");this._clickOffset=a?{left:0,top:0}:{left:e.pageX-u.left-i.width()/2,top:e.pageY-u.top-i.height()/2-(parseInt(i.css("borderTopWidth"),10)||0)-(parseInt(i.css("borderBottomWidth"),10)||0)+(parseInt(i.css("marginTop"),10)||0)};this.handles.hasClass("ui-state-hover")||this._slide(e,s,n);this._animateOff=!0;return!0}});$.extend($.easing,{def:"easeOutQuad",swing:function(e,t,n,r,i){return $.easing[$.easing.def](e,t,n,r,i)},easeInQuad:function(e,t,n,r,i){return r*(t/=i)*t+n},easeOutQuad:function(e,t,n,r,i){return-r*(t/=i)*(t-2)+n},easeInOutQuad:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t+n:-r/2*(--t*(t-2)-1)+n},easeInCubic:function(e,t,n,r,i){return r*(t/=i)*t*t+n},easeOutCubic:function(e,t,n,r,i){return r*((t=t/i-1)*t*t+1)+n},easeInOutCubic:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t*t+n:r/2*((t-=2)*t*t+2)+n}});