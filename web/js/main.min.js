// remap jQuery to $
function loadData(){$.when($.getJSON(siteContentMapFile),$.getJSON(siteContentHouseFile),$.getJSON(siteContentHouseStatusFile),$.getJSON(siteContentHouseMarkersFile)).done(function(e,t,n,r){var i=$.parseJSON(e[2].responseText),s=$.parseJSON(t[2].responseText),o=$.parseJSON(n[2].responseText),u=$.parseJSON(r[2].responseText);console.log(i);console.log(s);console.log(o);$.each(i,function(e,t){siteContentMap[t.id]=t});$.each(s,function(e,t){siteContentHouse[t.id]=t});$.each(o,function(e,t){siteContentHouseStatus[t.id]=t});$.each(u,function(e,t){siteContentHouseMarkers[t.id]=t});console.log(">>> Site content successfully loaded!");console.log(siteContentHouseMarkers);onSiteDataLoaded()})}function initViewNavigation(){$navItems.click(function(e){var t=e.target.hash;oldView=currentView;currentView=t.replace("#","");changeView(currentView);e.preventDefault();return!1})}function changeView(e){$navItems.parents("li").removeClass("active");$navItems.filter("."+e).parent("li").addClass("active");if(currentView=="intro-view")hideContentWrap();else if(oldView=="intro-view"){showContentWrap();initViewContent(initTime)}hideContentWrap();setTimeout(function(){showContentWrap()},400);currentView=="house-view"&&oldView=="map-view"?$contentMap.fadeOut(350,function(){updateProgressBars(currentTime);showContent(currentTime);$contentHouse.fadeIn({opacity:1},350)}):currentView=="map-view"&&oldView=="house-view"&&$contentHouse.fadeOut(350,function(){showMarkers(currentTime);updateProgressBars(currentTime);showContent(currentTime);$contentMap.fadeIn({opacity:1},350)});$viewSlider.attr("class",e+"-active")}function initTimeline(){function t(t,n,r){var i=null,s=null;for(var o=0;o<e.length;o++)if(t&&e[o]<=r||n&&e[o]>=r){var u=Math.abs(r-e[o]);if(s==null||u<s){i=e[o];s=u}}return i}$timeline=$("#timeline");$guides=$("#guides > div");$timelineValue=$("#timeline-value");var e=timeValues;$slider=$("#slider").slider({orientation:"horizontal",range:!0,min:0,max:60,values:[0,3],step:1,animate:!1,create:function(e,t){},slide:function(e,n){var r=e.keyCode!=$.ui.keyCode.RIGHT,i=e.keyCode!=$.ui.keyCode.LEFT,s=t(r,i,n.value);n.value==n.values[0]?$slider.slider("values",0,s):$slider.slider("values",1,s);return!1},start:function(e,t){},change:function(e,t){currentView=="house-view"&&(oldFloor=currentFloor);hideContent();currentTime=$slider.slider("values",1);$guides.removeClass("active").filter(".g"+currentTime).addClass("active");updateProgressBars(currentTime);updateClock(currentTime);setTimeout(function(){showContent(currentTime)},250);currentView=="map-view"&&showMarkers(currentTime)}})}function initViewContent(e){currentTime=e;hideContent();$slider.slider("values",1,e);$guides.removeClass("active").filter(".g"+currentTime).addClass("active");if(currentView=="map-view"){$contentMap.show();$contentHouse.hide()}else if(currentView=="house-view"){showMarkers(currentTime);$contentHouse.show();$contentMap.hide()}updateProgressBars(currentTime);showContent(currentTime)}function hideContent(){if(currentView=="map-view"){$problemsContent.stop(!0,!0).animate({opacity:0},250);$solutionsContent.stop(!0,!0).animate({opacity:0},250)}else if(currentView=="house-view"){oldFloor!=""&&currentFloor!=oldFloor&&$floorProfileContent.stop(!0,!0).animate({opacity:0},250);$floorProblemsContent.stop(!0,!0).animate({opacity:0},250)}}function showContent(e){e=e<10?"0"+e:e;if(currentView=="map-view"){$problemsContent.stop(!0,!0).html(siteContentMap["STD"+e].problemtext).animate({opacity:1},250);$solutionsContent.stop(!0,!0).html(siteContentMap["STD"+e].solutionstext).animate({opacity:1},250)}else if(currentView=="house-view"){$floorProfileContent.stop(!0,!0).html(getFloorProfileContent(currentFloor));oldFloor!=""&&currentFloor!=oldFloor&&$floorProfileContent.animate({opacity:1},250);$floorProblemsContent.stop(!0,!0).html(getFloorProblemsContent(currentFloor,e)).animate({opacity:1},250)}}function updateProgressBars(e){e=e<10?"0"+e:e;if(currentView=="map-view"){$mapProblemBars.find("#probbarverkehrschaos .progress-bar > div").css("width",siteContentMap["STD"+e].probbarverkehrschaos+"%");$mapProblemBars.find("#probbarmedizinischenotfaelle .progress-bar > div").css("width",siteContentMap["STD"+e].probbarmedizinischenotfaelle+"%");$mapProblemBars.find("#probbarkriminalitaet .progress-bar > div").css("width",siteContentMap["STD"+e].probbarkriminalitaet+"%");$mapProblemBars.find("#probbarpanik .progress-bar > div").css("width",siteContentMap["STD"+e].probbarpanik+"%");$mapSolutionBars.find("#resbarkommunikation .progress-bar > div").css("width",siteContentMap["STD"+e].resbarkommunikation+"%");$mapSolutionBars.find("#resbarversorgung .progress-bar > div").css("width",siteContentMap["STD"+e].resbarversorgung+"%");$mapSolutionBars.find("#resbarhandlungsfaehigkeit .progress-bar > div").css("width",siteContentMap["STD"+e].resbarhandlungsfaehigkeit+"%");$mapSolutionBars.find("#resbarsozialerzusammenhalt .progress-bar > div").css("width",siteContentMap["STD"+e].resbarsozialerzusammenhalt+"%")}else if(currentView=="house-view"){$houseProblemBars.find("#nahrungsbedarf .progress-bar > div").css("width",getFloorStatusValue("nahrungsbedarf",currentFloor,e)+"%");$houseProblemBars.find("#wasserbedarf .progress-bar > div").css("width",getFloorStatusValue("wasserbedarf",currentFloor,e)+"%");$houseProblemBars.find("#angst .progress-bar > div").css("width",getFloorStatusValue("angst",currentFloor,e)+"%");$houseSolutionBars.find("#koerper .progress-bar > div").css("width",getFloorStatusValue("koerper",currentFloor,e)+"%");$houseSolutionBars.find("#geistigeVerfassung .progress-bar > div").css("width",getFloorStatusValue("geistigeVerfassung",currentFloor,e)+"%");$houseSolutionBars.find("#handlungsfaehigkeit .progress-bar > div").css("width",getFloorStatusValue("handlungsfaehigkeit",currentFloor,e)+"%")}}function updateContent(e){hideContent();updateProgressBars(e);setTimeout(function(){showContent(e)},250)}function updateClock(e){var t="";e==0?t="Stand um 12:00h":e==3?t="Stand um 15:00h":e==6?t="Stand um 18:00h":e==12?t="Stand um 00:00h":e==24?t="Stand 1 Tag später":e==48&&(t="Stand 2 Tage später");$clock.fadeOut(250,function(){$clock.html(t).fadeIn(250)})}function animateClock(){$clock.fadeOut(250,function(){$clock.fadeIn(250)})}function getFloorProfileContent(e){var t="";e=="floor-1"?t=siteContentHouse.Steckbrief.mutter:e=="floor-2"?t=siteContentHouse.Steckbrief.altedame:e=="floor-3"&&(t=siteContentHouse.Steckbrief.wg);return t}function getFloorProblemsContent(e,t){var n="";e=="floor-1"?n=siteContentHouse["STD"+t].mutter:e=="floor-2"?n=siteContentHouse["STD"+t].altedame:e=="floor-3"&&(n=siteContentHouse["STD"+t].wg);return n}function getFloorStatusValue(e,t,n){var r=0;if(t=="floor-1"){e=="nahrungsbedarf"&&(r=siteContentHouseStatus["STD"+n].susinahrungsbedarf);e=="wasserbedarf"&&(r=siteContentHouseStatus["STD"+n].susiwasserbedarf);e=="angst"&&(r=siteContentHouseStatus["STD"+n].susiangst);e=="koerper"&&(r=siteContentHouseStatus["STD"+n].susikoerper);e=="geistigeVerfassung"&&(r=siteContentHouseStatus["STD"+n].susigeistigeVerfassung);e=="handlungsfaehigkeit"&&(r=siteContentHouseStatus["STD"+n].susihandlungsfaehigkeit)}else if(t=="floor-2"){e=="nahrungsbedarf"&&(r=siteContentHouseStatus["STD"+n].altedamenahrungsbedarf);e=="wasserbedarf"&&(r=siteContentHouseStatus["STD"+n].altedamewasserbedarf);e=="angst"&&(r=siteContentHouseStatus["STD"+n].altedameangst);e=="koerper"&&(r=siteContentHouseStatus["STD"+n].altedamekoerper);e=="geistigeVerfassung"&&(r=siteContentHouseStatus["STD"+n].altedamegeistigeVerfassung);e=="handlungsfaehigkeit"&&(r=siteContentHouseStatus["STD"+n].altedamehandlungsfaehigkeit)}else if(t=="floor-3"){e=="nahrungsbedarf"&&(r=siteContentHouseStatus["STD"+n].wgnahrungsbedarf);e=="wasserbedarf"&&(r=siteContentHouseStatus["STD"+n].wgwasserbedarf);e=="angst"&&(r=siteContentHouseStatus["STD"+n].wgangst);e=="koerper"&&(r=siteContentHouseStatus["STD"+n].wgkoerper);e=="geistigeVerfassung"&&(r=siteContentHouseStatus["STD"+n].wggeistigeVerfassung);e=="handlungsfaehigkeit"&&(r=siteContentHouseStatus["STD"+n].wghandlungsfaehigkeit)}return r}function showContentWrap(){$contentWrap.removeClass("hidden")}function hideContentWrap(){$contentWrap.addClass("hidden")}function resizeSite(){windowWidth=$window.width();windowHeight=$window.height()}function onLoad(){initViewNavigation();initTimeline();loadData()}function onSiteDataLoaded(){initViewContent(initTime)}function mapInRange(e,t,n,r,i){return(i-r)*(e-t)/(n-t)+r}(function(e){})(window.jQuery);var $window,$scrollElement,$nav,$navItems,$container,$viewSlider,$views,$slider,$guides,$timeline,$timelineValue,$contentWrap,$content,$contentMap,$problemsContent,$solutionsContent,$contentHouse,$floorProfileContent,$floorProblemsContent,$mapProblemBars,$mapSolutionBars,$houseProblemBars,$houseSolutionBars,$clock,$footer,initView="map-view",currentView="",oldView="",windowWidth,windowHeight,siteContentMap=[],siteContentHouse=[],siteContentHouseStatus=[],siteContentHouseMarkers=[],siteContentMapFile="data/RD_contentTableMap_export01.json",siteContentHouseFile="data/RD_contentTablePersona_export01.json";siteContentHouseStatusFile="data/RD_contentTablePersonaStatus_export01.json";siteContentHouseMarkersFile="data/RD_houseMarkers.json";var initTime=0,currentTime=initTime,timeValues=[0,3,6,12,24,48];$(document).ready(function(){$window=$(window);$scrollElement=$("html, body").scrollTop(0);$nav=$("#view-nav");$navItems=$nav.find("a");$container=$("#container");$viewSlider=$container.find("#view-slider");$views=$viewSlider.find("section");$contentWrap=$("#content-wrap");$content=$contentWrap.find("#content");$contentMap=$content.find("#content-map");$contentHouse=$content.find("#content-house");$problemsContent=$content.find("#problems-content");$solutionsContent=$content.find("#solutions-content");$floorProfileContent=$content.find("#floor-profile-content");$floorProblemsContent=$content.find("#floor-problems-content");$mapProblemBars=$content.find("#map-problem-bars");$mapSolutionBars=$content.find("#map-solution-bars");$houseProblemBars=$content.find("#house-problem-bars");$houseSolutionBars=$content.find("#house-solution-bars");$clock=$("#clock");$footer=$("footer");resizeSite();$(window).resize(resizeSite);currentView=initView;changeView(currentView);$(window).load(onLoad);if($("html").hasClass("multitouch")){$(document).bind("contextmenu",function(e){return!1});$("*").on("dragstart",function(e){e.preventDefault()});$("body, *").css("cursor","none");try{for(var e in document.styleSheets){var t=document.styleSheets[e];if(!t.rules)continue;for(var n=t.rules.length-1;n>=0;n--){if(!t.rules[n].selectorText)continue;t.rules[n].selectorText.match(":hover")&&stylesheet.deleteRule(n)}}}catch(r){}}});$.widget("ui.slider",$.ui.slider,{_mouseCapture:function(e){var t,n,r,i,s,o,u,a,f=this,l=this.options;if(l.disabled)return!1;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();t={x:e.pageX,y:e.pageY};n=this._normValueFromMouse(t);r=this._valueMax()-this._valueMin()+1;this.handles.each(function(e){if(!$(this).hasClass("ui-slider-handle-disabled")){var t=Math.abs(n-f.values(e));if(r>t||r===t&&(e===f._lastChangedValue||f.values(e)===l.min)){r=t;i=$(this);s=e}}});if(typeof i=="undefined")return!1;o=this._start(e,s);if(o===!1)return!1;this._mouseSliding=!0;this._handleIndex=s;i.addClass("ui-state-active").focus();u=i.offset();a=!$(e.target).parents().addBack().is(".ui-slider-handle")||$(e.target).parents().addBack().is(".ui-slider-handle-disabled");this._clickOffset=a?{left:0,top:0}:{left:e.pageX-u.left-i.width()/2,top:e.pageY-u.top-i.height()/2-(parseInt(i.css("borderTopWidth"),10)||0)-(parseInt(i.css("borderBottomWidth"),10)||0)+(parseInt(i.css("marginTop"),10)||0)};this.handles.hasClass("ui-state-hover")||this._slide(e,s,n);this._animateOff=!0;return!0}});$.extend($.easing,{def:"easeOutQuad",swing:function(e,t,n,r,i){return $.easing[$.easing.def](e,t,n,r,i)},easeInQuad:function(e,t,n,r,i){return r*(t/=i)*t+n},easeOutQuad:function(e,t,n,r,i){return-r*(t/=i)*(t-2)+n},easeInOutQuad:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t+n:-r/2*(--t*(t-2)-1)+n},easeInCubic:function(e,t,n,r,i){return r*(t/=i)*t*t+n},easeOutCubic:function(e,t,n,r,i){return r*((t=t/i-1)*t*t+1)+n},easeInOutCubic:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t*t+n:r/2*((t-=2)*t*t+2)+n}});